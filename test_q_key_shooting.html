<!DOCTYPE html>
<html>
<head>
    <title>Qé”®å°„å‡»æµ‹è¯•</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #2c3e50;
            color: white;
        }
        .test-container {
            background: #34495e;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        .status {
            padding: 10px;
            margin: 10px 0;
            border-radius: 4px;
        }
        .success { background-color: #27ae60; }
        .info { background-color: #3498db; }
        #shoot-indicator {
            font-size: 24px;
            text-align: center;
            padding: 20px;
            border: 2px solid #e74c3c;
            border-radius: 10px;
            margin: 20px 0;
        }
    </style>
</head>
<body>
    <h1>ğŸ¯ Qé”®å°„å‡»åŠŸèƒ½æµ‹è¯•</h1>
    
    <div class="test-container">
        <h2>æµ‹è¯•è¯´æ˜</h2>
        <p>æŒ‰ <strong>Qé”®</strong> æ¥æµ‹è¯•å°„å‡»åŠŸèƒ½</p>
        <p>å°„å‡»å†·å´æ—¶é—´ï¼š300æ¯«ç§’</p>
    </div>
    
    <div id="shoot-indicator">
        å‡†å¤‡å°„å‡»... æŒ‰Qé”®ï¼
    </div>
    
    <div class="test-container">
        <h2>æµ‹è¯•ç»“æœ</h2>
        <div id="test-results"></div>
    </div>
    
    <div class="test-container">
        <h2>å°„å‡»ç»Ÿè®¡</h2>
        <p>æ€»å°„å‡»æ¬¡æ•°: <span id="shot-count">0</span></p>
        <p>æœ€åå°„å‡»æ—¶é—´: <span id="last-shot">æœªå°„å‡»</span></p>
        <p>å†·å´å‰©ä½™: <span id="cooldown">0ms</span></p>
    </div>
    
    <script src="js/config.js"></script>
    <script src="js/input.js"></script>
    
    <script>
        let shotCount = 0;
        let lastShotTime = 0;
        
        const inputHandler = new InputHandler();
        const indicator = document.getElementById('shoot-indicator');
        const results = document.getElementById('test-results');
        
        // æ³¨å†Œå°„å‡»å›è°ƒ
        inputHandler.onShoot(() => {
            shotCount++;
            lastShotTime = Date.now();
            
            // æ›´æ–°æŒ‡ç¤ºå™¨
            indicator.textContent = 'ğŸ”¥ å°„å‡»æˆåŠŸï¼';
            indicator.style.backgroundColor = '#27ae60';
            
            // æ·»åŠ æµ‹è¯•ç»“æœ
            const result = document.createElement('div');
            result.className = 'status success';
            result.textContent = `âœ… ç¬¬${shotCount}æ¬¡å°„å‡»æˆåŠŸ - ${new Date().toLocaleTimeString()}`;
            results.appendChild(result);
            
            // æ›´æ–°ç»Ÿè®¡
            updateStats();
            
            // é‡ç½®æŒ‡ç¤ºå™¨
            setTimeout(() => {
                indicator.textContent = 'å‡†å¤‡å°„å‡»... æŒ‰Qé”®ï¼';
                indicator.style.backgroundColor = 'transparent';
            }, 500);
            
            console.log(`å°„å‡»æˆåŠŸï¼æ€»è®¡: ${shotCount}æ¬¡`);
        });
        
        // æ›´æ–°ç»Ÿè®¡ä¿¡æ¯
        function updateStats() {
            document.getElementById('shot-count').textContent = shotCount;
            document.getElementById('last-shot').textContent = 
                lastShotTime > 0 ? new Date(lastShotTime).toLocaleTimeString() : 'æœªå°„å‡»';
        }
        
        // æ›´æ–°å†·å´æ—¶é—´æ˜¾ç¤º
        function updateCooldown() {
            const remaining = inputHandler.getShootCooldownRemaining();
            document.getElementById('cooldown').textContent = remaining + 'ms';
            
            if (remaining > 0) {
                indicator.style.opacity = '0.5';
            } else {
                indicator.style.opacity = '1.0';
            }
        }
        
        // æ¸¸æˆå¾ªç¯
        function gameLoop() {
            inputHandler.update(16); // ~60fps
            updateCooldown();
            requestAnimationFrame(gameLoop);
        }
        
        // å¯åŠ¨
        gameLoop();
        updateStats();
        
        // æ·»åŠ é”®ç›˜äº‹ä»¶ç›‘å¬å™¨æ¥æ˜¾ç¤ºæŒ‰é”®
        document.addEventListener('keydown', (event) => {
            if (event.code === 'KeyQ') {
                const result = document.createElement('div');
                result.className = 'status info';
                result.textContent = `â„¹ï¸ æ£€æµ‹åˆ°Qé”®æŒ‰ä¸‹ - ${new Date().toLocaleTimeString()}`;
                results.appendChild(result);
            }
        });
        
        console.log('Qé”®å°„å‡»æµ‹è¯•å·²å‡†å¤‡å°±ç»ª');
        console.log('æŒ‰Qé”®è¿›è¡Œå°„å‡»æµ‹è¯•');
        
        // åˆå§‹åŒ–æµ‹è¯•ç»“æœ
        const initResult = document.createElement('div');
        initResult.className = 'status info';
        initResult.textContent = 'ğŸš€ æµ‹è¯•åˆå§‹åŒ–å®Œæˆï¼Œç­‰å¾…Qé”®è¾“å…¥...';
        results.appendChild(initResult);
    </script>
</body>
</html>